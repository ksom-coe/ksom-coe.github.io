<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
  <meta name="description" content="Kerala School of Mathematics - A premier research institute in Mathematics established by DAE and Government of Kerala." />
  <meta property="og:title" content="{{ title or 'Kerala School of Mathematics - Official Website' }}" />
  <meta property="og:image" content="https://ksom.res.in/Images/Main/Image-1.jpg" />
  <link rel="canonical" href="https://ksom.res.in/" />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#002b45" />
  <title>{{ title or 'Kerala School of Mathematics - Official Website' }}</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Merriweather:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Styles -->
  <link rel="stylesheet" href="/css/style.css" />

  <script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    packages: ['base', 'ams'],
    // Critical spacing adjustments
    inlineMathSpacing: {
      math: 0,
      text: 0
    },
    mathmlSpacing: {
      math: 0,
      text: 0
    },
    letterSpacing: '0em',
    wordSpacing: '0em'
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process',
    renderActions: {
      addMenu: [0, '', ''],
      checkLoading: [0, '', ''],
      // New action to apply spacing corrections
      applySpacing: [170, (doc) => {
        const math = doc.outputJax.document.mml;
        math.mathmlSpacing.math = 0;
        math.mathmlSpacing.text = 0;
      }, '']
    }
  },
  startup: {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function() {
        document.body.classList.add('mathjax-loaded');
        // Post-render spacing adjustment
        document.querySelectorAll('.MathJax_CHTML').forEach(el => {
          el.style.letterSpacing = '-0.5px';
          el.style.wordSpacing = '-0.3px';
        });
      });
    }
  },
  loader: { 
    load: ['[tex]/ams'],
    // Critical loader configuration
    paths: {mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5'},
    require: [
      '[tex]/ams',
      '[tex]/noundefined',
      '[tex]/physics'
    ]
  },
  // New CommonHTML configuration
  chtml: {
    scale: 1.0,
    minScale: 0.8,
    matchFontHeight: true,
    adaptiveCSS: false,
    mtextInheritFont: true,
    merrorInheritFont: true
  }
};
</script>
<script id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <!-- FullCalendar -->
  <script defer src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <!-- Netlify Identity -->
  <script defer src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body{% if compact_headings %} class="compact-headings-style"{% endif %}>
  {% include "header.html" %}

  <main class="full-width-wrapper">
    {{ content | safe }}
  </main>

  {% include "footer.html" %}
  {% include "modal.html" %}

  <script defer src="/js/main.js"></script>
</body>
</html>
