<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Official website of the Kerala School of Mathematics (KSoM)">
    <title>Kerala School of Mathematics (KSoM)</title>
    <link rel="icon" type="image/png" href="Images/KSoMLogo.png"> 
    
    <!-- Preload fonts for better performance -->
    <link rel="preload" href="https://fonts.gstatic.com/s/lora/v32/0QI-MX1D_JO_P-z_VA.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://fonts.gstatic.com/s/playfairdisplay/v30/nuFvEIDcmoIrZvjTeKhpO_mdGvIDP1tB.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://fonts.gstatic.com/s/spectral/v13/Mn_Oml_Qe56krmxnu_uI.woff2" as="font" type="font/woff2" crossorigin> <!-- Added Spectral font preload -->
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Inter:wght@400;500;700&family=Spectral:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS to mimic IAS design and enhance KSoM, and MFO layout */
        :root {
            --ias-blue: #007295;
            --ias-dark-blue: #005e7c;
            --ias-light-blue: #dfedf1;
            --ias-text-color: #333333; /* Darker text for readability */
            --ias-grey-bg: #f9f9f9;
            --ias-teal: #008f8f; /* From IAS site for links */
            --highlight-red: #d62828; /* New red color from suggested CSS */
            --highlight-blue: #003049; /* New dark blue from suggested CSS */
        }

        body {
            font-family: 'Spectral', serif; /* Changed to Spectral as requested */
            color: var(--ias-text-color);
            background-color: var(--ias-grey-bg);
            font-size: 16px; /* Base font size for calculations */
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif; /* Headings font */
            color: var(--ias-dark-blue);
        }
        
        /* Navigation Bar Font - IAS style */
        .main-nav ul li a, .dropdown-menu a {
            font-family: 'Lora', serif; /* Use Lora for nav items for a more IAS-like feel */
            font-weight: 500;
        }

        /* === Modern Navigation Bar === */
        .site-header {
            background-color: white; /* White background */
            border-bottom: 1px solid #eee; /* Light border */
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); /* Subtle shadow */
            padding-top: 0.75rem; /* Header spacing fix */
            padding-bottom: 0.75rem; /* Header spacing fix */
        }
        .site-header-inner {
            padding: 1.5rem 2rem; /* Increased vertical padding and consistent horizontal padding */
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .main-nav ul {
            display: flex;
            gap: 1.25rem; /* Adjusted gap as per request */
            list-style: none; /* Remove default list style */
        }
        .main-nav ul li a {
            font-family: 'Inter', sans-serif; /* Changed to Inter as per request */
            font-size: 1rem;
            font-weight: 500;
            color: var(--highlight-blue); /* Dark blue color */
            text-decoration: none;
            padding: 0.25rem 0;
            position: relative;
            transition: color 0.2s ease;
            letter-spacing: 0.01em; /* Optional visual boost */
        }
        .main-nav ul li a::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--highlight-red); /* Red underline on hover */
            transition: width 0.3s ease;
        }
        .main-nav ul li a:hover::after {
            width: 100%;
        }

        .site-logo-img {
            height: 48px; /* Adjust logo size */
            width: auto;
            border-radius: 9999px; /* Make logo circular */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .dept-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--ias-blue);
            line-height: 1;
        }

        .university-name {
            font-family: 'Lora', serif;
            font-size: 0.8rem;
            color: var(--ias-text-color);
            margin-top: 0.2rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        /* Dropdown styles */
        .dropdown-menu {
            display: none;
            position: absolute;
            background-color: #ffffff;
            min-width: 180px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            z-index: 10;
            border-radius: 0.5rem;
            overflow: hidden;
            transform: translateY(10px);
            opacity: 0;
            visibility: hidden;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out, visibility 0.3s ease-out;
        }
        .dropdown:hover .dropdown-menu {
            display: block;
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .dropdown-menu li > a { /* Adjusted selector for better targeting */
            padding: 10px 18px; /* Adjusted vertical padding */
            font-size: 0.95rem; /* Slightly larger font size */
            color: var(--ias-text-color) !important;
            text-decoration: none;
            display: block;
            white-space: nowrap;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
        .dropdown-menu a:hover {
            background-color: var(--ias-light-blue);
            color: var(--ias-dark-blue) !important;
        }

        /* Mobile Navigation */
        .mobile-menu-button {
            display: none; /* Hidden by default on desktop */
            font-size: 2rem;
            color: var(--ias-blue);
            cursor: pointer;
            z-index: 1001;
        }
        .mobile-nav {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.98);
            z-index: 999;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transform: translateX(100%);
            transition: transform 0.4s ease-out;
            backdrop-filter: blur(5px);
        }
        .mobile-nav.open {
            transform: translateX(0);
        }
        .mobile-nav ul {
            list-style: none;
            padding: 0;
            text-align: center;
            width: 80%;
        }
        .mobile-nav ul li {
            margin: 1rem 0;
        }
        .mobile-nav ul li a {
            font-size: 1.5rem;
            color: var(--ias-dark-blue);
            text-decoration: none;
            display: block;
            padding: 0.5rem 0;
        }
        .mobile-nav ul li a:hover {
            color: var(--ias-blue);
        }
        .mobile-nav .dropdown-menu {
            position: static;
            display: block;
            background-color: transparent;
            box-shadow: none;
            padding-top: 0.5rem;
            opacity: 1;
            visibility: visible;
            transform: none;
        }
        .mobile-nav .dropdown-menu a {
            font-size: 1.2rem;
            padding: 0.3rem 0;
            color: #555 !important;
        }
        .mobile-nav .dropdown-menu a:hover {
            background-color: transparent;
            color: var(--ias-blue) !important;
        }

        /* === Layout Container (Unified Width and Padding) === */
        .container, .site-header-inner, .main-layout-container, .site-footer > .container {
            max-width: 1280px; /* Consistent max-width */
            margin: 0 auto;
            padding: 0 2rem; /* Consistent horizontal padding */
        }
        .main-layout-container { /* Re-apply vertical padding for the main content area */
            padding-top: 2rem;
            padding-bottom: 2rem;
        }

        /* Campus Photo */
        .campus-photo-container {
            height: 250px; /* Default height */
            position: relative;
            border-radius: 0.75rem; /* Re-added for consistency */
            overflow: hidden; /* Re-added for consistency */
        }
        .campus-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.7);
        }
        /* === Overlay Text on Image (Bottom Left with Aesthetic Font) === */
        .campus-photo-overlay-content {
            position: absolute;
            bottom: 1.5rem; /* Position from bottom */
            left: 2rem; /* Position from left */
            text-align: left; /* Align text to left */
            color: #f8f9fa; /* Light grey for text */
            text-shadow: 0 2px 4px rgba(0,0,0,0.6); /* Text shadow for readability */
            width: calc(100% - 4rem); /* Ensure it doesn't overflow if text is long */
            max-width: 500px; /* Max width to keep lines readable */
        }
        .campus-title {
            font-size: 1.5rem; /* Larger title within overlay */
            font-weight: 700;
            font-family: 'Playfair Display', serif; /* Aesthetic font */
            margin-bottom: 0.25rem;
        }
        .campus-subtitle {
            font-size: 1rem; /* Subtitle within overlay */
            font-family: 'Inter', sans-serif; /* Aesthetic font */
            line-height: 1.4;
            color: #eaeaea; /* Slightly different shade for subtitle */
            max-width: 500px; /* Max width for readability */
        }
        @media (min-width: 768px) {
            .campus-photo-overlay-content .campus-title {
                font-size: 2rem; /* Slightly larger on desktop for impact */
            }
            .campus-photo-overlay-content .campus-subtitle {
                font-size: 1.1rem; /* Slightly larger on desktop */
            }
        }


        /* === Card Styles (unified for most content blocks) === */
        /* Base styles for all main cards */
        .full-width-card, .expandable-card, .calendar-widget, .latest-news-block, .upcoming-events-section, .outreach-section {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.04);
            padding: 1.5rem; /* Consistent padding for main blocks */
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Default gap between elements inside these cards */
        }

        .expandable-card {
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05); /* Lighter shadow for inner cards */
            padding: 1rem; /* Smaller padding for inner cards */
            overflow: hidden;
            gap: 1rem; /* Smaller gap for inner cards */
            position: relative; /* Added for z-index to work */
            z-index: 1; /* Added for hover expansion visibility */
        }
        .expandable-card:hover {
            transform: scale(1.015);
            z-index: 5;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* === Desktop Grid Layout === */
        @media (min-width: 1024px) {
            .main-layout-container {
                display: grid;
                /* Define 3 columns: 2 for the left 75% block (each 37.5%), 1 for the right 25% block */
                grid-template-columns: 3fr 3fr 2fr; /* This gives 37.5% + 37.5% + 25% */
                grid-template-rows: auto auto auto auto; /* Flexible rows */
                grid-template-areas:
                  "image-area       image-area        calendar-area"
                  "about-area       about-area        news-area"
                  "research-area    programmes-area   events-area"
                  "activities-area  outreach-area     ."; /* . means an empty cell for potential overflow */
                /* Reduced gap for tighter layout */
                gap: 1.2rem;
                align-items: start;
            }

            /* Grid Area Assignments */
            .campus-photo-container { grid-area: image-area; height: 220px; }
            .about-section { grid-area: about-area; }
            .research-section { grid-area: research-area; }
            .programmes-section { grid-area: programmes-area; }
            .activities-section { grid-area: activities-area; }
            .outreach-section { grid-area: outreach-area; }
            .calendar-widget { grid-area: calendar-area; }
            .latest-news-block { grid-area: news-area; }
            .upcoming-events-section { grid-area: events-area; }


            /* Vertical separators for the desktop grid */
            /* Border between the two 50/50 columns within the 75% left block */
            .programmes-section, .outreach-section { /* Programmes and Outreach are now in the right of the 75% block */
                border-left: 1px solid rgba(0,0,0,0.08);
                padding-left: 1rem;
            }

            /* Border between the 75% block and 25% sidebar */
            .calendar-widget, .latest-news-block, .upcoming-events-section {
                border-left: 1px solid rgba(0,0,0,0.08);
                padding-left: 1rem;
            }

            /* Ensure main content sections align correctly */
            .research-section,
            .programmes-section,
            .activities-section,
            .outreach-section {
                margin-top: 0; /* Override any default margin-top from card styles */
                margin-bottom: 0; /* Rely on grid gap for spacing */
            }
            /* Remove specific margin from about-section's inner div if it causes extra space */
            .about-section > div {
                margin-bottom: 0; /* Ensure no other margin causes issue */
            }
            /* Apply specific margin for full-width and expandable cards to ensure proper spacing within grid */
            .full-width-card, .expandable-card {
                margin-top: 0;
                margin-bottom: 0;
            }
        }


        /* === Unified Section Headings === */
        .section-heading {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--highlight-blue); /* Darker blue from suggested CSS */
            border-bottom: 2px solid var(--highlight-red); /* Red from suggested CSS */
            padding-bottom: 0.5rem;
            margin-bottom: 0.5rem; /* Slightly more space below heading */
            width: 100%; /* Ensure headings span full width within their logical column content */
        }
        /* Smaller headings for right sidebar (and now also calendar), and remove borders in those sections */
        .calendar-widget .section-heading,
        .latest-news-block .section-heading,
        .upcoming-events-section .section-heading {
            font-size: 1.2rem; /* Smaller heading for denser sidebar */
            border: none; /* Remove border from headings in these blocks */
            padding-bottom: 0; /* Remove padding if border is gone */
            margin-bottom: 0.5rem; /* Keep consistent bottom margin */
        }
        /* Ensure the first heading in these blocks doesn't have an extra top margin */
        .calendar-widget .section-heading:first-child,
        .latest-news-block .section-heading:first-child,
        .upcoming-events-section .section-heading:first-child {
            margin-top: 0;
        }

        /* === Text Block Style (General paragraphs not in cards) === */
        /* These styles apply generally to paragraphs inside full-width-card, expandable-card, and specific main sections */
        .full-width-card p,
        .expandable-card > p, /* Direct paragraphs in expandable cards like Research/Activities intro */
        .calendar-widget p,
        .latest-news-block p,
        .upcoming-events-section p,
        .outreach-section p {
            font-size: 0.95rem; /* Slightly smaller for density */
            line-height: 1.6;
            color: #333;
            text-align: justify;
            margin-bottom: 1rem; /* Standard paragraph margin */
            width: 100%; /* Ensure full width use */
        }


        /* === Card Block (Programmes, Research, Events, Activities, News items, etc.) === */
        /* Updated .card-block to remove transform on hover and use lighter shadow */
        .card-block { /* This is for items *within* expandable cards (e.g., individual research areas, news items) */
            display: block; /* Make it a block element to be clickable */
            background-color: #fdfdfd; /* Beautified minimal card styling */
            border-radius: 0.5rem;
            padding: 1rem; /* Beautified minimal card styling */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03); /* Very light shadow */
            transition: box-shadow 0.2s ease, transform 0.2s ease; /* Smooth transition for box-shadow */
            text-decoration: none; /* Remove underline for clickable cards */
            color: inherit; /* Inherit text color from parent for default links */
            width: 100%; /* Ensure full width usage within column */
            max-width: none; /* Remove any max-width constraints */
            border-left: none; /* Ensure border-left is removed */
        }
        .card-block:hover {
            box-shadow: 0 1px 3px rgba(0,0,0,0.06); /* subtle only */
            transform: none; /* remove jump effect */
        }
        .card-block h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--highlight-blue);
            margin-bottom: 0.3rem;
        }
        /* Specific paragraph style for content *within* .card-block items */
        .card-block p {
            font-size: 0.83rem; /* Smaller font size for item descriptions */
            color: #444;
            margin-bottom: 0; /* Remove margin-bottom for paragraphs inside cards */
            line-height: 1.5; /* Consistent line height for card text */
        }

        /* Specific card elements for dates and location */
        .card-block .news-date-text,
        .card-block .event-date-text,
        .card-block .event-location,
        .card-block .event-time {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.1rem;
            display: block;
        }

        /* === Read More Links (for general 'View All' links at bottom of sections) === */
        .read-more-link, .view-all-link {
            font-size: 0.9rem;
            color: var(--highlight-red);
            font-weight: 500;
            text-decoration: none;
            margin-top: 0.5rem;
            display: inline-block;
        }
        .read-more-link:hover, .view-all-link:hover {
            text-decoration: underline;
        }

        /* === Responsive Truncation === */
        /* Core truncation mechanism - should be applied to any element that needs to be truncated */
        .truncated-text {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            /* Font-size and line-height are defined by specific selectors below or parent elements */
        }

        /* Specific truncation for main introductory paragraphs (e.g., About KSoM, Research Areas intro) */
        .full-width-card p.truncated-text,
        .expandable-card > p.truncated-text { /* Target direct paragraphs inside these cards */
            -webkit-line-clamp: 6; /* Limit to 6 lines */
            max-height: calc(6 * 1.6em); /* Based on parent 'p' line-height */
        }

        /* Specific truncation for descriptions within individual .card-block items */
        .card-block p.truncated-text {
            -webkit-line-clamp: 3; /* Limit to 3 lines for smaller items */
            max-height: calc(3 * 1.5em); /* Based on .card-block p line-height */
        }

        /* Re-added: Expand on hover for truncated text within expandable cards */
        .expandable-card:hover .truncated-text {
            -webkit-line-clamp: unset !important; /* Remove line clamping */
            max-height: unset !important; /* Allow full height */
            overflow: visible !important; /* Make content visible */
            text-overflow: clip !important; /* Prevent ellipsis */
        }

        /* Calendar specific styling */
        #calendar-container {
            font-family: 'Inter', sans-serif;
            background-color: #fff;
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        #calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background-color: var(--ias-light-blue);
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            font-weight: 600;
            color: var(--highlight-blue);
        }
        #calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            padding: 0.5rem;
        }
        .day-header {
            text-align: center;
            font-weight: 500;
            font-size: 0.8rem;
            color: #666;
            padding: 0.25rem 0;
        }
        .day-cell {
            text-align: center;
            padding: 0.5rem 0;
            font-size: 0.9rem;
            border-radius: 0.25rem;
            background-color: #f9f9f9;
            color: #333;
        }
        .day-cell.current-month {
            background-color: #ffffff;
        }
        .day-cell.today {
            background-color: var(--highlight-red);
            color: white;
            font-weight: 700;
        }
        .day-cell.inactive {
            color: #bbb;
            background-color: #f0f0f0;
        }


        /* Footer */
        .site-footer {
            background-color: var(--ias-dark-blue);
            color: var(--ias-light-blue);
            padding: 2.5rem 1.5rem;
            font-size: 0.9rem;
        }
        .footer-logo-text {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 700;
            line-height: 1;
            color: #ffffff;
        }
        .footer-university-name {
            font-family: 'Lora', serif;
            font-size: 0.7rem;
            color: #a0d0e0;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        .footer-nav ul li a, .footer-social-links a {
            color: var(--ias-light-blue);
            transition: color 0.3s ease;
        }
        .footer-nav ul li a:hover, .footer-social-links a:hover {
            color: #ffffff;
        }

        /* Responsive adjustments for mobile */
        @media (max-width: 1023px) { /* Changed breakpoint to align with desktop grid */
            .main-layout-container {
                flex-direction: column; /* Stack on mobile */
                gap: 1.5rem; /* Adjust gap for mobile sections */
            }
            /* Reset grid properties on mobile */
            .main-layout-container {
                display: flex; /* Override display grid */
                grid-template-columns: none;
                grid-template-rows: none;
                grid-template-areas: none;
            }
            .main-layout-container > * { /* Reset all direct children grid areas */
                grid-area: unset !important;
                width: 100%; /* Full width on mobile */
                margin-bottom: 0 !important; /* Reset margin from desktop grid */
                padding-left: 0 !important; /* Reset padding from desktop borders */
                border-left: none !important; /* Remove borders */
            }
            .campus-photo-container {
                height: 200px; /* Even shorter image on mobile */
            }
            .campus-title {
                font-size: 1.8rem;
            }
            .campus-subtitle {
                font-size: 0.9rem;
            }
            .section-heading {
                font-size: 1.1rem;
            }
            /* Re-add border for headings on mobile for unified sidebar content */
            .calendar-widget .section-heading,
            .latest-news-block .section-heading,
            .upcoming-events-section .section-heading {
                 border-bottom: 2px solid var(--highlight-red);
                 padding-bottom: 0.5rem;
                 margin-top: 1.5rem; /* Add margin between sections */
            }
            .calendar-widget .section-heading:first-child,
            .latest-news-block .section-heading:first-child,
            .upcoming-events-section .section-heading:first-child {
                margin-top: 0; /* No top margin for the very first heading in the unified block */
            }

            /* Mobile Ordering */
            /* Order of sections on mobile */
            .latest-news-block { order: 1; } /* Latest News */
            .upcoming-events-section { order: 2; } /* Upcoming Events */
            .research-section { order: 3; } /* Research */
            .programmes-section { order: 4; } /* Programmes */
            .activities-section { order: 5; } /* Activities */
            .outreach-section { order: 6; } /* Outreach */
            .campus-photo-container { order: 7; } /* Campus Photo */
            .about-section { order: 8; } /* About KSoM */
            .calendar-widget { order: 9; } /* Calendar */
            
            /* Hide About KSoM and Calendar on smaller screens */
            [data-grid-area="about"],
            [data-grid-area="calendar"] {
                display: none !important;
            }
        }
        /* Mobile specific adjustments for header, logo, and nav */
        @media (max-width: 767px) {
            .site-header-inner {
                padding: 0.8rem 1rem;
            }
            .site-logo-img {
                height: 40px;
            }
            .dept-title {
                font-size: 1.5rem;
            }
            .university-name {
                font-size: 0.7rem;
            }
            .main-nav {
                display: none;
            }
            .mobile-menu-button {
                display: block;
            }
            /* News/Events items as cards on mobile */
            .card-block h4 {
                font-size: 0.95rem;
            }
            .news-date-text, .event-date-text {
                margin-top: 0.3rem;
            }
        }
    </style>
</head>
<body>

    <!-- Header Content -->
    <header class="site-header">
        <div class="site-header-inner">
            <!-- Logo and Institution Branding -->
            <div class="site-branding">
                <a href="/" class="site-logo-link flex items-center">
                    <!-- Updated logo path -->
                    <img src="Images/KSoMLogo.png" alt="Kerala School of Mathematics Logo" class="site-logo-img" onerror="this.onerror=null;this.src='https://placehold.co/48x48/007295/ffffff?text=K';" />
                    <div class="flex flex-col ml-2">
                        <p class="dept-title">KSoM</p>
                        <p class="university-name">KERALA SCHOOL OF MATHEMATICS</p>
                    </div>
                </a>
            </div>

            <!-- Desktop Navigation -->
            <nav id="desktop-nav" class="main-nav md:flex hidden" aria-label="Main Navigation">
                <ul id="nav-items" class="flex"> <!-- Removed space-x-6 as requested -->
                    <li><a href="#about" class="hover:text-ias-blue active">About</a></li>
                    <li class="dropdown relative">
                        <a href="#programmes" class="hover:text-ias-blue">Programmes</a>
                        <ul class="dropdown-menu absolute top-full left-0 mt-2 rounded-md shadow-lg bg-white z-10">
                            <li><a href="/programmes/integrated-msc-phd.html" class="block">Integrated MSc-PhD</a></li>
                            <li><a href="/programmes/phd.html" class="block">PhD Programme</a></li>
                            <li><a href="/programmes/postdoctoral.html" class="block">Postdoctoral Programme</a></li>
                        </ul>
                    </li>
                    <li class="dropdown relative">
                        <a href="#people" class="hover:text-ias-blue">People</a>
                        <ul class="dropdown-menu absolute top-full left-0 mt-2 rounded-md shadow-lg bg-white z-10">
                            <li><a href="/people/faculty.html" class="block">Faculty</a></li>
                            <li><a href="/people/postdoctoral-fellows.html" class="block">Postdoctoral Fellows</a></li>
                            <li><a href="/people/research-scholars.html" class="block">Research Scholars</a></li>
                            <li><a href="/people/students.html" class="block">Students</a></li>
                        </ul>
                    </li>
                    <li><a href="#research" class="hover:text-ias-blue">Research</a></li>
                    <li class="dropdown relative">
                        <a href="#activities" class="hover:text-ias-blue">Activities</a>
                        <ul class="dropdown-menu absolute top-full left-0 mt-2 rounded-md shadow-lg bg-white z-10">
                            <li><a href="/activities/seminars.html" class="block">Colloquiums & Seminars</a></li>
                            <li><a href="/activities/conferences.html" class="block">Conferences</a></li>
                            <li><a href="/activities/workshops.html" class="block">Workshops</a></li>
                        </ul>
                    </li>
                    <li class="dropdown relative">
                        <a href="#resources" class="hover:text-ias-blue">Resources</a>
                        <ul class="dropdown-menu absolute top-full left-0 mt-2 rounded-md shadow-lg bg-white z-10">
                            <li><a href="/resources/library.html" class="block">Library</a></li>
                            <li><a href="/resources/archive.html" class="block">Archive</a></li>
                        </ul>
                    </li>
                    <li><a href="#contact" class="hover:text-ias-blue">Contact</a></li>
                </ul>
            </nav>

            <!-- Mobile Menu Button -->
            <div class="mobile-menu-button md:hidden" id="mobile-menu-button">
                &#9776; <!-- Hamburger icon -->
            </div>
        </div>
    </header>

    <!-- Mobile Navigation (hidden by default) -->
    <nav id="mobile-nav" class="mobile-nav hidden md:hidden">
        <div class="mobile-menu-button absolute top-4 right-4" id="mobile-menu-close-button">
            &times; <!-- Close icon -->
        </div>
        <ul id="mobile-nav-items">
            <!-- Content will be populated by JavaScript -->
        </ul>
    </nav>

    <main id="main-content">
        <!-- Main Layout Container - uses CSS Grid for desktop, Flex Column for mobile -->
        <section class="main-layout-container">

            <!-- Campus Photo Block (top-left 75% on desktop, order 7 on mobile) -->
            <div class="campus-photo-container" data-grid-area="image" data-mobile-order="7">
                <img src="Images/KSoMCampus.jpg" alt="KSoM Campus" class="campus-photo"
                     onerror="this.onerror=null;this.src='https://placehold.co/1920x600/005080/ffffff?text=KSoM+Campus';">
                <div class="campus-photo-overlay-content">
                    <h1 class="campus-title">Kerala School of Mathematics</h1>
                    <p class="campus-subtitle">
                        An autonomous institution established jointly by the Science & Technology Department, Govt. of Kerala and the Department of Atomic Energy, Govt. of India.
                    </p>
                </div>
            </div>

            <!-- Calendar Widget (top of right sidebar on desktop, order 9 on mobile) -->
            <div class="calendar-widget full-width-card" data-grid-area="calendar" data-mobile-order="9">
                <h2 class="section-heading">Events Calendar</h2>
                <div id="calendar" class="rounded border p-2 bg-white shadow-sm"></div>
            </div>

            <!-- Latest News (top-right 25% on desktop, order 1 on mobile) -->
            <section class="latest-news-block expandable-card" data-grid-area="news" data-mobile-order="1">
                <h2 class="section-heading">Latest News</h2> 
                <div class="space-y-3">
                    <!-- News Item 1 -->
                    <a href="/news/registrar-recruitment.html" class="news-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h4 class="font-semibold text-base mb-1 text-ias-blue">Recruitment of Registrar</h4>
                        <span class="news-date-text">June 03, 2025</span>
                        <p class="text-gray-700 text-sm truncated-text">
                            KSoM is seeking a qualified candidate for the position of Registrar. Responsibilities include administrative operations, student records, and coordinating with various departments. A master's degree and relevant experience are required.
                        </p>
                    </a>
                    <!-- News Item 2 -->
                    <a href="/news/phd-admissions-2025.html" class="news-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h4 class="font-semibold text-base mb-1 text-ias-blue">KSoM-Ph.D. Admissions 2025 - Advertisement</h4>
                        <span class="news-date-text">May 07, 2025</span>
                        <p class="text-gray-700 text-sm truncated-text">
                            Advertisement for the Ph.D. Programme admissions for 2025 has been released. Prospective candidates are invited to apply through the official website. The deadline for applications is July 15, 2025.
                        </p>
                    </a>
                    <!-- News Item 3 -->
                    <a href="/news/autonomous-status.html" class="news-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h4 class="font-semibold text-base mb-1 text-ias-blue">KSoM Gains Autonomous Status</h4>
                        <span class="news-date-text">April 25, 2025</span>
                        <p class="text-gray-700 text-sm truncated-text">
                            KSoM has officially become an autonomous institution, delinked from KSCSTE. This new status grants KSoM greater flexibility in academic and administrative matters, paving the way for enhanced research and educational initiatives.
                        </p>
                    </a>
                </div>
                <a href="/news.html" class="view-all-link text-ias-teal font-semibold mt-3 block text-right">View All News &rarr;</a>
            </section>

            <!-- About KSoM (Full width of 75% block on desktop, order 8 on mobile) -->
            <section class="about-section full-width-card" data-grid-area="about" data-mobile-order="8">
                <h2 class="section-heading">About KSoM</h2>
                <div> <!-- Removed mb-4 class from here to control spacing better -->
                    <!-- Removed the image as requested -->
                    <p class="truncated-text">
                        Kerala School of Mathematics (KSoM) is an advanced research institute in Mathematics which started in 2007 as a joint venture of the Department of Atomic Energy (DAE), Government of India and the Science and Technology Department, Government of Kerala. KSoM was founded with the vision of establishing a centre of excellence for research in Mathematics and to revive the glory of a school by a similar name which flourished between the fourteenth and sixteenth century in Kerala.

                        The main objective of Kerala School of Mathematics is conduct of high quality Mathematical Research. Our mission is to create a vibrant academic environment that promotes cutting-edge research, nurtures young mathematicians, and contributes significantly to the global mathematical community.
                    </p>
                    <a href="/about.html" class="read-more-link mt-auto block text-right">Read More About Us &rarr;</a>
                </div>
            </section>

            <!-- Research Areas (part of left 75% block on desktop, order 3 on mobile) -->
            <section class="research-section expandable-card" data-grid-area="research" data-mobile-order="3">
                <h2 class="section-heading">Research Areas at KSoM</h2>
                <p class="truncated-text mb-4">
                    KSoM is a vibrant hub for advanced mathematical research, with faculty and scholars engaged in cutting-edge work across diverse fields. Our research initiatives aim to push the boundaries of theoretical and applied mathematics, fostering an environment of rigorous inquiry and intellectual discovery. Key areas of focus include:
                </p>
                <div class="space-y-4">
                    <a href="/research/complex-analysis.html" class="research-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Complex Analysis</h3>
                        <p class="text-gray-600 truncated-text">Investigation of the impact of Hörmander's estimates on properties of the Bers domain and implications of the Kobayashi metric isometric to the Teichmüller metric. Research spans complex analysis, Teichmüller theory, and differential geometry, utilizing functional analysis and PDE techniques.</p>
                    </a>
                    <a href="/research/braid-groups.html" class="research-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Braid Groups & Mapping Class Groups</h3>
                        <p class="text-gray-600 truncated-text">Exploration of intricate relationships between braid groups and mapping class groups, with emphasis on liftability and the Birman-Hilden property. Focus includes unitary representations, their classification, irreducibility, and connections to quantum invariants in knot theory and low-dimensional topology.</p>
                    </a>
                    <a href="/research/non-commutative-functional-analysis.html" class="research-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Non-commutative Functional Analysis</h3>
                        <p class="text-gray-600 truncated-text">Investigation of quantum aspects of approximation and convexity within operator spaces and systems in C*-algebras. Research covers completely bounded approximation, quantum convexity, matricial ranges, and structure theory of operator systems, with implications for quantum mechanics.</p>
                    </a>
                    <a href="/research/harmonic-analysis.html" class="research-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Harmonic Analysis</h3>
                        <p class="text-gray-600 truncated-text">Research on modulation spaces, Fourier multipliers, twisted convolution operators, maximal functions along hypersurfaces, Hardy-Sobolev inequalities in non-commutative settings, and spherical maximal operators. Applications include signal processing, image reconstruction, and partial differential equations.</p>
                    </a>
                    <a href="/research/analytic-number-theory.html" class="research-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Analytic Number Theory</h3>
                        <p class="text-gray-600 truncated-text">Research on multiple zeta values, explicit averages of multiplicative functions, Möbius sums with coprimality conditions, and chromatic generalizations. This area uses real and complex analysis to study integers, prime distribution, and arithmetic functions, with connections to cryptography.</p>
                    </a>
                </div>
                <a href="/research.html" class="read-more-link mt-auto block text-right">View All Research Areas &rarr;</a>
            </section>

            <!-- Programmes (part of right of 75% block on desktop, order 4 on mobile) -->
            <section class="programmes-section expandable-card" data-grid-area="programmes" data-mobile-order="4">
                <h2 class="section-heading">Our Programmes</h2>
                <div class="space-y-4">
                    <a href="/programmes/integrated-msc-phd.html" class="programme-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Integrated M.Sc. - Ph.D. Programme</h3>
                        <p class="text-gray-600 truncated-text">
                            An advanced postgraduate training program designed for research careers in Mathematics, with options in Physics or Theoretical Computer Science. It offers monthly scholarships and hostel facilities. Admission is based on a written test and interview, requiring a B.Sc. in Mathematics/Physics or B.E./B.Tech. with strong mathematical background. The curriculum includes advanced courses and early research engagement.
                        </p>
                    </a>
                    <a href="/programmes/phd.html" class="programme-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3 class="text-ias-blue">Ph.D. Programme</h3>
                        <p class="text-gray-600 truncated-text">
                            Aimed at highly motivated students for mathematical research careers, offering a Ph.D. in Pure and Applied Mathematics. Students work closely with faculty on advanced problems, typically spanning five years with initial coursework and intensive research. Financial support includes fellowships and conference opportunities.
                        </p>
                    </a>
                    <a href="/programmes/postdoctoral.html" class="programme-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3 class="text-ias-blue">Postdoctoral Programme</h3>
                        <p class="text-gray-600 truncated-text">
                            Fellowships for outstanding young researchers with recently completed Ph.D.s for independent research in a stimulating environment. Fellows receive competitive stipends and research grants, conducting original research and participating in teaching. Fellowships are typically two years, extendable based on performance, with access to excellent facilities.
                        </p>
                    </a>
                </div>
                <a href="/programmes.html" class="read-more-link mt-auto block text-right">View All Programmes &rarr;</a>
            </section>

            <!-- Other Activities (part of left 75% block on desktop, order 5 on mobile) -->
            <section class="activities-section expandable-card" data-grid-area="activities" data-mobile-order="5">
                <h2 class="section-heading">Other Activities</h2>
                <div class="space-y-4">
                    <a href="/activities/workshop-number-theory.html" class="activity-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Workshop on Number Theory</h3>
                        <p class="text-gray-600 truncated-text">
                            A five-day workshop on "Recent Advances in Analytic Number Theory" (March 10-14, 2025) featured lectures by renowned mathematicians and parallel sessions for young researchers. Keynote speakers covered topics like L-functions and sieve methods, fostering discussions and collaborations among over 100 participants.
                        </p>
                    </a>
                    <a href="/activities/algebraic-geometry-seminar.html" class="activity-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Weekly Algebraic Geometry Seminar</h3>
                        <p class="text-gray-600 truncated-text">
                            Our ongoing weekly Algebraic Geometry seminar attracts a strong audience, with recent talks on "Moduli Spaces of Curves." It provides a platform for faculty, post-docs, and Ph.D. students to present research and engage in discussions on topics like intersection theory and derived categories.
                        </p>
                    </a>
                    <a href="/activities/outreach-program.html" class="activity-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>Mathematics Outreach Program</h3>
                        <p class="text-gray-600 truncated-text">
                            KSoM faculty and students participated in a local outreach program to promote mathematics among high school students. Interactive sessions and workshops covered fascinating aspects like Fractals, Game Theory, and Cryptography, aiming to inspire young minds towards mathematical sciences.
                        </p>
                    </a>
                </div>
                <a href="/activities.html" class="read-more-link mt-auto block text-right">View All Activities &rarr;</a>
            </section>

            <!-- Outreach (part of right of 75% block on desktop, order 6 on mobile) -->
            <section class="outreach-section expandable-card" data-grid-area="outreach" data-mobile-order="6">
                <h2 class="section-heading">Outreach</h2>
                <div class="space-y-4">
                    <a href="/outreach/swim-ksom.html" class="outreach-item block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h3>SWIM@KSoM: Summer Workshop in Mathematics</h3>
                        <p class="text-gray-600 truncated-text">
                            SWIM@KSoM is an annual summer workshop by KSoM, introducing undergraduates to advanced mathematics for research careers. The two-week program features lectures, problem-solving, and discussions led by KSoM faculty and experts, covering Abstract Algebra, Real Analysis, Topology, and Number Theory. It bridges undergraduate curriculum with higher mathematics, promoting critical thinking and independent problem-solving. Selection is competitive, based on merit and application.
                        </p>
                    </a>
                    <a href="https://ksom-swim.github.io/" target="_blank" class="read-more-link mt-auto block text-right">Visit SWIM@KSoM website &rarr;</a>
                </div>
            </section>
            
            <!-- Upcoming Events (part of right 25% block on desktop, order 2 on mobile) -->
            <section class="upcoming-events-section expandable-card" data-grid-area="events" data-mobile-order="2">
                <h2 class="section-heading">Upcoming Events</h2>
                <div class="space-y-4">
                    <a href="/events/ravi-kumar-lecture.html" class="event-item-card block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h4 class="font-semibold text-base mb-1 text-ias-blue">Guest Lecture: Dr. Ravi Kumar (IIT Bombay)</h4>
                        <span class="event-date-text">July 15, 2025</span>
                        <p class="text-gray-600 truncated-text">
                            Topic: Advances in Number Theory. This lecture is part of the ongoing seminar series and is open to all students and faculty.
                        </p>
                    </a>
                    <a href="/events/cryptography-workshop.html" class="event-item-card block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h4 class="font-semibold text-base mb-1 text-ias-blue">Workshop on Cryptography and its Applications</h4>
                        <span class="event-date-text">August 01, 2025</span>
                        <p class="event-location text-gray-600 text-sm">KSoM Computing Lab</p>
                        <p class="event-time text-gray-600 text-sm">August 1-7, 2025</p>
                        <p class="text-gray-700 truncated-text">
                            A week-long workshop for research scholars and faculty focusing on symmetric and asymmetric key cryptography, hash functions, and digital signatures.
                        </p>
                    </a>
                    <a href="/events/phd-exam.html" class="event-item-card block px-4 py-3 bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors">
                        <h4 class="font-semibold text-base mb-1 text-ias-blue">Ph.D. Entrance Examination</h4>
                        <span class="event-date-text">August 20, 2025</span>
                        <p class="event-location text-gray-600 text-sm">KSoM Examination Halls</p>
                        <p class="event-time text-gray-600 text-sm">9:30 AM onwards</p>
                        <p class="text-gray-700 truncated-text">
                            The annual entrance examination for Ph.D. admissions will be conducted on campus.
                        </p>
                    </a>
                </div>
                <a href="/events.html" class="read-more-link mt-auto block text-right">View All Events &rarr;</a>
            </section>

        </section>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container grid grid-cols-1 md:grid-cols-4 gap-8">
            <!-- Branding -->
            <div class="col-span-1 md:col-span-1">
                <a href="/" class="flex items-center mb-4">
                    <img src="Images/KSoMLogo.png" alt="KSoM Logo" class="h-10 w-10 rounded-full mr-2" onerror="this.onerror=null;this.src='https://placehold.co/40x40/007295/ffffff?text=K';">
                    <div class="flex flex-col">
                        <p class="footer-logo-text">KSoM</p>
                        <p class="university-name">KERALA SCHOOL OF MATHEMATICS</p>
                    </div>
                </a>
                <p class="mb-4">Dedicated to advancing mathematical frontiers through rigorous research and education.</p>
                <div class="flex space-x-4">
                    <a href="#" class="hover:text-white" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="hover:text-white" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="hover:text-white" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" class="hover:text-white" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>

            <!-- Quick Links -->
            <div>
                <h3 class="text-xl font-semibold mb-4 text-white">Quick Links</h3>
                <ul class="footer-nav space-y-2">
                    <li><a href="#about" class="hover:underline">About Us</a></li>
                    <li><a href="#programmes" class="hover:underline">Programmes</a></li>
                    <li><a href="#research" class="hover:underline">Research Areas</a></li>
                    <li><a href="#activities" class="hover:underline">Activities</a></li>
                    <li><a href="/news.html" class="hover:underline">News & Events</a></li>
                </ul>
            </div>

            <!-- Resources -->
            <div>
                <h3 class="text-xl font-semibold mb-4 text-white">Resources</h3>
                <ul class="footer-nav space-y-2">
                    <li><a href="/resources/library.html" class="hover:underline">Library</a></li>
                    <li><a href="/resources/archive.html" class="hover:underline">Archive</a></li>
                    <li><a href="/activities/seminars.html" class="hover:underline">Seminars</a></li>
                    <li><a href="/activities/workshops.html" class="hover:underline">Workshops</a></li>
                    <li><a href="#" class="hover:underline">Alumni Network</a></li>
                </ul>
            </div>

            <!-- Contact Us -->
            <div>
                <h3 class="text-xl font-semibold mb-4 text-white">Contact Us</h3>
                <p>Kerala School of Mathematics<br>
                C. P. Ummer Road<br>
                Kunnamangalam P. O.<br>
                Kozhikode, Kerala, 673570 India</p>
                <p class="mt-2">Email: <a href="mailto:info@ksom.ac.in" class="hover:underline">info@ksom.ac.in</a></p>
                <p>Phone: <a href="tel:+914952809000" class="hover:underline">+91 495 2809000</a></p>
            </div>
        </div>
        <div class="text-center mt-8 pt-8 border-t border-ias-blue-light text-sm">
            &copy; 2025 Kerala School of Mathematics. All rights reserved.
        </div>
    </footer>

    <!-- Font Awesome for social icons -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId.startsWith('#')) { // Only handle internal links
                    document.querySelector(targetId).scrollIntoView({
                        behavior: 'smooth'
                    });
                } else {
                    // For external links, allow default behavior
                    window.location.href = targetId;
                }
            });
        });

        // Function to populate mobile navigation from desktop navigation
        function populateMobileNav() {
            const desktopNavItems = document.getElementById('nav-items');
            const mobileNavItems = document.getElementById('mobile-nav-items');
            
            // Clear existing mobile nav items
            mobileNavItems.innerHTML = '';

            // Clone desktop nav items and append to mobile nav
            Array.from(desktopNavItems.children).forEach(desktopItem => {
                const mobileLi = document.createElement('li');
                const desktopLink = desktopItem.querySelector('a');
                
                // Clone the main link
                const mobileLink = desktopLink.cloneNode(true);
                // Remove any 'active' class on clone if it exists
                mobileLink.classList.remove('active'); 
                // Remove the extra span for dropdown arrow from the cloned link, if it exists
                const arrowSpan = mobileLink.querySelector('span');
                if (arrowSpan) {
                    arrowSpan.remove();
                }

                mobileLi.appendChild(mobileLink);

                // If it's a dropdown, clone its menu too
                const dropdownMenu = desktopItem.querySelector('.dropdown-menu');
                if (dropdownMenu) {
                    const mobileDropdownUl = dropdownMenu.cloneNode(true);
                    mobileDropdownUl.classList.remove('absolute', 'top-full', 'left-0', 'mt-2', 'shadow-lg', 'bg-white', 'z-10');
                    mobileDropdownUl.classList.add('static', 'block', 'shadow-none', 'bg-transparent', 'text-left'); // Adjust for mobile display
                    // Remove any cloned 'active' class from dropdown items
                    Array.from(mobileDropdownUl.querySelectorAll('a')).forEach(itemLink => {
                        itemLink.classList.remove('active');
                    });
                    mobileLi.appendChild(mobileDropdownUl);
                }
                mobileNavItems.appendChild(mobileLi);
            });
        }

        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenuCloseButton = document.getElementById('mobile-menu-close-button');
        const mobileNav = document.getElementById('mobile-nav');

        mobileMenuButton.addEventListener('click', () => {
            mobileNav.classList.remove('hidden');
            setTimeout(() => {
                mobileNav.classList.add('open');
            }, 10); // Small delay for transition
        });

        mobileMenuCloseButton.addEventListener('click', () => {
            mobileNav.classList.remove('open');
            setTimeout(() => {
                mobileNav.classList.add('hidden');
            }, 400); // Wait for transition to complete before hiding
        });

        // Close mobile menu when a link is clicked
        mobileNav.addEventListener('click', (event) => {
            const clickedLink = event.target.closest('a');
            if (clickedLink) {
                // Check if the clicked link navigates to a new page (e.g., has an actual href that's not just a #anchor)
                // or if it's a sub-item within a dropdown menu.
                // We want the main mobile nav to close if a concrete navigation link is clicked.
                if (clickedLink.getAttribute('href') && !clickedLink.getAttribute('href').startsWith('#')) {
                    mobileNav.classList.remove('open');
                    setTimeout(() => {
                        mobileNav.classList.add('hidden');
                    }, 400);
                } else if (clickedLink.closest('.dropdown-menu')) {
                    // If it's a link inside a dropdown, and it's an internal link, close the main nav.
                    if (clickedLink.getAttribute('href') && clickedLink.getAttribute('href').startsWith('/')) {
                        mobileNav.classList.remove('open');
                        setTimeout(() => {
                            mobileNav.classList.add('hidden');
                        }, 400);
                    }
                }
            }
        });
        
        // Initial population on page load for consistency (even if not immediately opened)
        document.addEventListener('DOMContentLoaded', populateMobileNav);

        // Calendar generation script
        function generateCalendar(elementId) {
            const calendarEl = document.getElementById(elementId);
            if (!calendarEl) return;

            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();

            // Create date object for the first day of the current month
            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const startDayOfWeek = firstDayOfMonth.getDay(); // 0 for Sunday, 1 for Monday, etc.

            const monthNames = ["January", "February", "March", "April", "May", "June",
                                "July", "August", "September", "October", "November", "December"];
            const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

            let calendarHTML = `
                <div id="calendar-header">
                    <span>${monthNames[currentMonth]} ${currentYear}</span>
                </div>
                <div id="calendar-grid">
            `;

            // Add day headers
            dayNames.forEach(day => {
                calendarHTML += `<div class="day-header">${day}</div>`;
            });

            // Add blank cells for days before the 1st
            for (let i = 0; i < startDayOfWeek; i++) {
                calendarHTML += `<div class="day-cell inactive"></div>`;
            }

            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = (day === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear());
                calendarHTML += `
                    <div class="day-cell current-month ${isToday ? 'today' : ''}">
                        ${day}
                    </div>
                `;
            }

            calendarHTML += `</div>`;
            calendarEl.innerHTML = calendarHTML;
        }

        document.addEventListener("DOMContentLoaded", function () {
            generateCalendar("calendar");
        });

    </script>
    <!-- MathJax Configuration and script -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          packages: ['base', 'ams']
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process',
          renderActions: {
            addMenu: [0, '', ''],
            checkLoading: [0, '', '']
          }
        },
        startup: {
          pageReady() {
            return MathJax.startup.defaultPageReady().then(function () {
              document.body.classList.add('mathjax-loaded');
            });
          }
        },
        loader: { load: ['[tex]/ams'] }
      };
    </script>
    <script id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
